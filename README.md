# LiveConfig

`liveconfig` — это Go-пакет для работы с динамическими конфигурациями, предоставляющий функционал отслеживания 
изменений YAML-файла и подписки на изменения конкретных параметров.

## Возможности

- Автоматическое обновление конфигурации при изменении файла.
- Подписка на изменения параметров с уведомлением о старом и новом значении.

## Установка

```bash
go get "git.server.home/pkg/liveconfig"
```

## Использование

### 1. Инициализация

```go
package main

import (
	"fmt"

	"git.server.home/pkg/liveconfig"
)

func main() {
	// Инициализация liveconfig
	liveconfig.Init("config.yaml")

	// Подписка на изменения параметра
	liveconfig.Sub("app.notify_before", func(newValue, oldValue any) {
		fmt.Printf("Параметр 'app.notify_before' изменился с %v на %v\n", oldValue, newValue)
	})

	select {} // Блокируем выполнение
}
```

Любые изменения в конфигурационном файле автоматически подхватываются пакетом. Если значение подписанного
параметра изменяется, вызывается соответствующий обработчик.

## Технические детали

1. **Отслеживание изменений файла**:
   Используется пакет [`fsnotify`](https://pkg.go.dev/github.com/fsnotify/fsnotify) для отслеживания изменений конфигурационного файла.

2. **Потокобезопасность**:
   Доступ к конфигурации и подписчикам защищён с помощью `sync.RWMutex`.

3. **Уведомления**:
   Подписчики уведомляются только в случае, если значение параметра действительно изменилось.

## Зависимости

- [fsnotify](https://pkg.go.dev/github.com/fsnotify/fsnotify)
- [yaml.v2](https://pkg.go.dev/gopkg.in/yaml.v2)
- [log/slog](https://pkg.go.dev/log/slog)

## Ограничения

- Конфигурационный файл должен быть в формате YAML.
